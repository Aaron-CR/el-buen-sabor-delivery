<app-dialog title=" {{ action }} Dirección ">
  <mat-horizontal-stepper #stepper>
    <!-- PASO 1 -->
    <mat-step label="Dirección de entrega" [stepControl]="addressFormGroup">
      <form novalidate [formGroup]="addressFormGroup">
        <!-- Alias Input -->
        <mat-form-field class="w-100">
          <mat-label>Alias</mat-label>
          <input matInput required formControlName="alias" placeholder="Ej. Casa, Trabajo, Otro...">
          <mat-error *ngIf="errorHandling('alias', 'required')">
            El alias es <strong>obligatorio</strong>.
          </mat-error>
        </mat-form-field>
        <!-- Calle Input -->
        <mat-form-field class="w-100">
          <mat-label>Calle</mat-label>
          <input matInput required formControlName="calle" placeholder="Ej. San Martin">
          <mat-error *ngIf="errorHandling('calle', 'required')">
            El nombre de la calle es <strong>obligatorio</strong>.
          </mat-error>
        </mat-form-field>
        <div class="d-flex">
          <!-- Número Input -->
          <mat-form-field class="w-100">
            <mat-label>Número</mat-label>
            <input matInput required formControlName="numero" placeholder="Por favor indique el número.">
            <mat-error *ngIf="errorHandling('numero', 'required')">
              El número de la calle es <strong>obligatorio</strong>.
            </mat-error>
          </mat-form-field>
          <!-- Piso Input -->
          <mat-form-field class="w-100 mx-3">
            <mat-label>Piso</mat-label>
            <input matInput placeholder="Por favor indique el piso." formControlName="piso">
          </mat-form-field>
          <!-- Departamento Input -->
          <mat-form-field class="w-100">
            <mat-label>Departamento</mat-label>
            <input matInput placeholder="Por favor indique el departamento." formControlName="departamento">
          </mat-form-field>
        </div>
        <!-- Aclaracion Textarea -->
        <mat-form-field class="w-100">
          <mat-label>Aclaraciones</mat-label>
          <textarea matInput formControlName="aclaraciones"
            placeholder="Instrucciones de entrega, por ejemplo, frente a …"></textarea>
        </mat-form-field>
        <!-- Localidad Select -->
        <mat-form-field class="w-100">
          <mat-label>Localidad</mat-label>
          <mat-select formControlName="localidad" required>
            <mat-option *ngFor="let localidad of localidades" [value]="localidad">
              {{ localidad.nombre | titlecase }}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="errorHandling('localidad', 'required')">
            La localidad es <strong>obligatoria</strong>.
          </mat-error>
        </mat-form-field>
        <div class="d-flex flex-row-reverse">
          <button mat-flat-button color="primary" matStepperNext>Siguiente</button>
        </div>
      </form>
    </mat-step>
    <mat-step label="Confirmá tu ubicación" [stepControl]="addressFormGroup">
      <!-- PASO 2 -->
      <h2>Para una mejor experiencia, confirmá tu ubicación de entrega.</h2>
      <form novalidate [formGroup]="addressFormGroup">
        <agm-map [latitude]="latitude" [longitude]="longitude" [zoom]="zoom">
          <agm-marker [latitude]="latitude" [longitude]="longitude" [markerDraggable]="true"
            (dragEnd)="markerDragEnd($event)"></agm-marker>
        </agm-map>
        <div class="d-flex align-items-center py-2">
          <mat-icon color="primary" class="material-icons">place</mat-icon>
          <div> {{ address }} </div>
        </div>
        <div class="d-flex flex-row-reverse">
          <button mat-flat-button color="primary" [disabled]="!addressFormGroup.valid" (click)="onAction()">
            {{ action }} ubicación
          </button>
          <button mat-button class="mr-2" (click)="onCancel()">Cancel</button>
        </div>
      </form>
    </mat-step>
    <!-- Icon overrides. -->
    <ng-template matStepperIcon="edit">
      <mat-icon class="material-icons-outlined">edit_location</mat-icon>
    </ng-template>
  </mat-horizontal-stepper>
</app-dialog>
